一	工程项目：
1	项目名称：pmsm_encoder_foc
2	项目使用的资源与软件：
(1)	正点原子阿波罗STM32H743开发板
(2)	正点原子无刷电机驱动板
(3)	Keil uvision5
(4)	Minibalance波形上位机显示3.5（可选）

二	工程目标：
1	实验现象：
(1)	使用按键控制永磁同步电机的启停、正转、反转、加速、减速动作。
(2)	使用速度环进行电机转速的PID控制。
2	实验内容：
(1)	使用vvvf方法，启动永磁同步电机。
(2)	使用无感换向方法，根据反电动势的过零信号进行永磁同步电机的换向操作。
(3)	按下开发板上不同的按键，直流无刷电机可以进行启停、正转、反转、加速、减速操作。
(4)	进行永磁同步电机的开环控制和闭环速度控制，闭环速度控制使用PID控制对电机转速进行控制。
3	具体要求：
(1)	按键控制永磁同步电机时，按下相应的按键可以使得电机正常地启停、正转、反转、加速、减速。
(2)	使用vvvf方法，启动永磁同步电机。
(3)	使用无感换向方法，并根据反电动势的过零信号进行换向操作。
(4)	使用编码器进行速度反馈。
(5)	电机错误状态的捕获并及时进行异常处理，包括当电机堵转时、vvvf出错、过零检测出错等，及时关闭驱动桥停止电机运转。
(6)	根据开环、闭环控制系统的结构，进行结构化、模块化编程。
(7)	使用PID控制对永磁同步电机的转速进行控制，包含位置式PID控制和增量式PID控制两种方法，转速控制精度±1%。

三	学习目标（下述内容非先后顺序）：
1	学习永磁同步电机及电机驱动板的基本原理：
(1)	了解永磁同步电机的基本概念与结构。
(2)	掌握永磁同步电机的运行原理。
(3)	了解永磁同步电机驱动板的驱动桥基本原理，加深原理图分析理解能力。
2	学习永磁同步电机的vvvf启动的基本原理：
(1)	了解vvvf的工作原理。
(2)	了解vvvf启动电机时，正传、反转的各自换向操作。
3	学习永磁同步电机的反电动势过零检测无感换向的基本原理：
(1)	了解反电动势的产生以及对应的电压电流波形。
(2)	了解反电动势过零检测的工作原理。
(3)	掌握永磁同步电机正反转两种情况下，反电动势过零检测信号的变化情况。
4	学习增量式光电编码器测速的基本原理：
(1)	了解增量式光电编码器的测速原理。
(2)	使用光电编码器进行转速测量。
5	学习STM32H743的外设使用：
(1)	掌握STM32H743的高级定时器（TIM1或TIM8）的使用方法，包括3相PWM互补输出、编码器模式等。
(2)	掌握STM32H743的定时器的使用方法，包括定时中断等。
(3)	了解STM32H743的时钟树结构及配置。
6	学习速度环闭环控制和PID控制：
(1)	了解电机速度环闭环控制的系统结构，每一部分对应什么元器件。
(2)	根据开环控制、闭环控制的系统结构，编写每一部分对应的程序，增强系统结构化、模块化编程能力。
(3)	掌握PID控制的基本原理以及PID参数调试方法。
(4)	掌握位置式PID控制和增量式PID控制的原理。

四	可以重复利用的资源：
1	工程项目目录下Library下面的内容，包括STM32H7的HAL库、Minibalance波形上位机显示的程序代码。
2	工程项目目录下User\fw\pmsm_ctrl目录，这里包含了永磁同步电机的开环、闭环速度控制的源代码，以及vvvf启动、反电动势过零检测的源代码。

五	注意事项：
1	该项目包含永磁同步电机的反电动势过零检测、开环控制和闭环速度控制，具体功能使用由design_define.h里面的宏定义决定。
2	系统上电前，务必检查电路接线是否正确，包括电机与驱动板的连接、驱动板和开发板的连接；务必检查程序中换向操作是否正确，绝对不允许每一项的上下管同时导通。
3	小编时间仓促，因此项目中有不完善的地方敬请大家提出建议。
4	学习交流群1126635164。

六	项目环境目录介绍：
项目目录下，各文件夹的含义是（含空文件夹，加粗的是本项目包含的文件）：
Doc目录为项目文档，包括参考资料、设计文档、原理图等。
Library目录为项目所使用到的库文件，包括Monitor、Model、ThirdParty Firmware等。
Project目录为项目包含的工程的目录，包括firmware工程等，以及工程专用代码、脚本等。
User目录包含用户主要的项目文件，包含firmware代码等。

目前最适合的使用方法是使用Cygwin，编辑代码、文件操作在Cygwin下面，软件使用在Windows下面，可以大幅节省开发时间。后期会开发快捷键切换目录，届时适合在Cygwin、Linux环境下运行。

